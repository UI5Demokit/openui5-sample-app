/*
 * OpenUI5
 * (c) Copyright 2009-2021 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Manifest","./ComponentMetadata","./Element","sap/base/util/extend","sap/base/util/deepExtend","sap/base/util/merge","sap/ui/base/ManagedObject","sap/ui/base/ManagedObjectRegistry","sap/ui/core/ResizeHandler","sap/ui/thirdparty/URI","sap/ui/performance/trace/Interaction","sap/base/assert","sap/base/Log","sap/base/util/ObjectPath","sap/base/util/UriParameters","sap/base/util/isPlainObject","sap/base/util/LoaderExtensions","sap/ui/VersionInfo","sap/ui/core/mvc/ViewType"],function(e,t,n,i,r,a,o,s,u,c,f,p,d,l,g,m,h,v,y){"use strict";var M={lazy:"lazy",eager:"eager",waitFor:"waitFor"};function _(e){["sap-client","sap-server"].forEach(function(t){if(!e.hasSearch(t)){var n=sap.ui.getCore().getConfiguration().getSAPParam(t);if(n){e.addSearch(t,n)}}})}function w(e,t,n,i){if(n){for(var r in e){if(!t[r]&&n[r]&&n[r].uri){t[r]=i}}}}function C(e,n,i,a){var o=n.getEntry(i);if(o!==undefined&&!m(o)){return o}var s,u;if(a&&(s=e.getParent())instanceof t){u=s.getManifestEntry(i,a)}if(u||o){o=r({},u,o)}return o}function b(e,t){var n=Object.create(Object.getPrototypeOf(e));n._oMetadata=e;n._oManifest=t;for(var i in e){if(!/^(getManifest|getManifestObject|getManifestEntry|getMetadataVersion)$/.test(i)&&typeof e[i]==="function"){n[i]=e[i].bind(e)}}n.getManifest=function(){return t&&t.getJson()};n.getManifestObject=function(){return t};n.getManifestEntry=function(n,i){return C(e,t,n,i)};n.getMetadataVersion=function(){return 2};return n}function S(e,t,n){p(typeof e==="function","fn must be a function");var i=o._sOwnerId;try{o._sOwnerId=t;return e.call(n)}finally{o._sOwnerId=i}}var O=o.extend("sap.ui.core.Component",{constructor:function(e,t){var n=Array.prototype.slice.call(arguments);if(typeof e!=="string"){t=e;e=undefined}if(t&&typeof t._metadataProxy==="object"){this._oMetadataProxy=t._metadataProxy;this._oManifest=t._metadataProxy._oManifest;delete t._metadataProxy;this.getMetadata=function(){return this._oMetadataProxy}}if(t&&typeof t._cacheTokens==="object"){this._mCacheTokens=t._cacheTokens;delete t._cacheTokens}if(t&&Array.isArray(t._activeTerminologies)){this._aActiveTerminologies=t._activeTerminologies;delete t._activeTerminologies}if(t&&typeof t._manifestModels==="object"){this._mManifestModels=t._manifestModels;delete t._manifestModels}else{this._mManifestModels={}}this._mServices={};this._oKeepAliveConfig=this.getManifestEntry("/sap.ui5/keepAlive");if(this._oKeepAliveConfig){this._oKeepAliveConfig.supported=!!this._oKeepAliveConfig.supported}this._bIsActive=true;this._aDestroyables=[];o.apply(this,n)},metadata:{stereotype:"component",abstract:true,specialSettings:{componentData:"any"},version:"0.0",includes:[],dependencies:{libs:[],components:[],ui5version:""},config:{},customizing:{},library:"sap.ui.core"}},t);s.apply(O,{onDeregister:function(e){n.registry.forEach(function(t){if(t._sapui_candidateForDestroy&&t._sOwnerId===e&&!t.getParent()){d.debug("destroying dangling template "+t+" when destroying the owner component");t.destroy()}})}});O.prototype.getManifest=function(){if(!this._oManifest){return this.getMetadata().getManifest()}else{return this._oManifest.getJson()}};O.prototype.getManifestEntry=function(e){return this._getManifestEntry(e)};O.prototype._getManifestEntry=function(e,t){if(!this._oManifest){return this.getMetadata().getManifestEntry(e,t)}else{return C(this.getMetadata(),this._oManifest,e,t)}};O.prototype.getManifestObject=function(){if(!this._oManifest){return this.getMetadata().getManifestObject()}else{return this._oManifest}};O.prototype._isVariant=function(){if(this._oManifest){var e=this.getManifestEntry("/sap.ui5/componentName");return e&&e!==this.getManifestEntry("/sap.app/id")}else{return false}};O.activateCustomizing=function(e){};O.deactivateCustomizing=function(e){};O.getOwnerIdFor=function(e){p(e instanceof o,"oObject must be given and must be a ManagedObject");var t=e instanceof o&&e._sOwnerId;return t||undefined};O.getOwnerComponentFor=function(e){return O.get(O.getOwnerIdFor(e))};O.prototype.runAsOwner=function(e){if(!this.isActive()){throw new Error("Execute 'runAsOwner' on an inactive owner component is not supported. Component: '"+this.getMetadata().getName()+"' with id '"+this.getId()+"'.")}return S(e,this.getId())};O.prototype.getInterface=function(){return this};O.prototype._initCompositeSupport=function(e){this.oComponentData=e&&e.componentData;if(this._oManifest){this._oManifest.init(this)}else{this.getMetadata().init()}if(this._isVariant()){var t=this._oManifest.getEntry("/sap.app/id");if(t){T(t,this._oManifest.resolveUri("./","manifest"))}}this.initComponentModels();if(this.onWindowError){this._fnWindowErrorHandler=function(e){var t=e.originalEvent;this.onWindowError(t.message,t.filename,t.lineno)}.bind(this);window.addEventListener("error",this._fnWindowErrorHandler)}if(this.onWindowBeforeUnload){this._fnWindowBeforeUnloadHandler=function(e){var t=this.onWindowBeforeUnload.apply(this,arguments);if(typeof t==="string"){e.returnValue=t;e.preventDefault();return t}}.bind(this);window.addEventListener("beforeunload",this._fnWindowBeforeUnloadHandler)}if(this.onWindowUnload){this._fnWindowUnloadHandler=this.onWindowUnload.bind(this);window.addEventListener("unload",this._fnWindowUnloadHandler)}};O.prototype._getDestroyables=function(){if(!this._aDestroyables){d.error("Mandatory super constructor not called for Component: '"+this.getManifestObject().getComponentName()+"'.",null,"sap.ui.support",function(){return{type:"missingSuperConstructor"}});this._aDestroyables=[]}return this._aDestroyables};O.prototype.destroy=function(){for(var e in this._mServices){if(this._mServices[e].instance){this._mServices[e].instance.destroy()}}delete this._mServices;for(var t in this._mManifestModels){this._mManifestModels[t].destroy()}delete this._mManifestModels;if(this._fnWindowErrorHandler){window.removeEventListener("error",this._fnWindowErrorHandler);delete this._fnWindowErrorHandler}if(this._fnWindowBeforeUnloadHandler){window.removeEventListener("beforeunload",this._fnWindowBeforeUnloadHandler);delete this._fnWindowBeforeUnloadHandler}if(this._fnWindowUnloadHandler){window.removeEventListener("unload",this._fnWindowUnloadHandler);delete this._fnWindowUnloadHandler}if(this._oEventBus){this._oEventBus.destroy();delete this._oEventBus}function n(e){if(e&&!e._bIsBeingDestroyed){e.destroy()}}var i=this._getDestroyables();for(var r=0;r<i.length;r++){i[r]=i[r].then(n)}o.prototype.destroy.apply(this,arguments);sap.ui.getCore().getMessageManager().unregisterObject(this);if(this._oManifest){this._oManifest.exit(this);delete this._oManifest}else{this.getMetadata().exit()}return Promise.all(i)};O.prototype.getComponentData=function(){return this.oComponentData};O.prototype.getEventBus=function(){if(!this._oEventBus){var e=this.getMetadata().getName();d.warning("Synchronous loading of EventBus, due to #getEventBus() call on Component '"+e+"'.","SyncXHR",null,function(){return{type:"SyncXHR",name:e}});var t=sap.ui.requireSync("sap/ui/core/EventBus");this._oEventBus=new t;if(!this.isActive()){this._oEventBus.suspend()}}return this._oEventBus};O.prototype.isActive=function(){return this._bIsActive};O.prototype.initComponentModels=function(){var e=this.getMetadata();if(e.isBaseClass()){return}var t=this._getManifestEntry("/sap.app/dataSources",true)||{};var n=this._getManifestEntry("/sap.ui5/models",true)||{};this._initComponentModels(n,t,this._mCacheTokens)};O.prototype._initComponentModels=function(e,t,n){var i=O._createManifestModelConfigurations({models:e,dataSources:t,component:this,mergeParent:true,cacheTokens:n,activeTerminologies:this.getActiveTerminologies()}),r={},a;if(!i){return}for(a in i){if(!this._mManifestModels[a]){r[a]=i[a]}}var o=O._createManifestModels(r,this.toString());for(a in o){this._mManifestModels[a]=o[a]}for(a in this._mManifestModels){var s=this._mManifestModels[a];this.setModel(s,a||undefined)}};O.prototype.getService=function(e){if(!this._mServices[e]){this._mServices[e]={};this._mServices[e].promise=new Promise(function(t,n){sap.ui.require(["sap/ui/core/service/ServiceFactoryRegistry"],function(i){var r=this._getManifestEntry("/sap.ui5/services/"+e,true);var a=r&&r.factoryName;if(!a){n(new Error("Service "+e+" not declared!"));return}var o=i.get(a);if(o){o.createInstance({scopeObject:this,scopeType:"component",settings:r.settings||{}}).then(function(i){if(!this.bIsDestroyed){this._mServices[e].instance=i;this._mServices[e].interface=i.getInterface();t(this._mServices[e].interface)}else{n(new Error("Service "+e+" could not be loaded as its Component was destroyed."))}}.bind(this)).catch(n)}else{var s="The ServiceFactory "+a+" for Service "+e+" not found in ServiceFactoryRegistry!";var u=this._getManifestEntry("/sap.ui5/services/"+e+"/optional",true);if(!u){d.error(s)}n(new Error(s))}}.bind(this),n)}.bind(this))}return this._mServices[e].promise};function E(e,t){var n=e._getManifestEntry("/sap.ui5/services",true);var i=t?[]:null;if(!n){return i}var r=Object.keys(n);if(!t&&r.some(function(e){return n[e].startup===M.waitFor})){throw new Error('The specified component "'+e.getMetadata().getName()+'" cannot be loaded in sync mode since it has some services declared with "startup" set to "waitFor"')}return r.reduce(function(t,i){if(n[i].lazy===false||n[i].startup===M.waitFor||n[i].startup===M.eager){var r=e.getService(i);if(n[i].startup===M.waitFor){t.push(r)}}return t},i)}O.prototype.createComponent=function(e){p(typeof e==="string"&&e||typeof e==="object"&&typeof e.usage==="string"&&e.usage,"vUsage either must be a non-empty string or an object with a non-empty usage id");var t={async:true};if(e){var n;if(typeof e==="object"){n=e.usage;["id","async","settings","componentData"].forEach(function(n){if(e[n]!==undefined){t[n]=e[n]}})}else if(typeof e==="string"){n=e}t=this._enhanceWithUsageConfig(n,t)}var i=O._createComponent(t,this);if(i instanceof Promise){this.registerForDestroy(i)}return i};O.prototype._enhanceWithUsageConfig=function(e,t){var n=this.getManifestEntry("/sap.ui5/componentUsages/"+e);if(!n){throw new Error('Component usage "'+e+'" not declared in Component "'+this.getManifestObject().getComponentName()+'"!')}if(n.activeTerminologies){throw new Error("Terminologies vector can't be used in component usages")}return r(n,t)};O.prototype.getActiveTerminologies=function(){return this._aActiveTerminologies?this._aActiveTerminologies.slice():undefined};O._createComponent=function(e,t){function n(){if(e.async===true){return O.create(e)}else{return sap.ui.component(e)}}if(t){if(!t.isActive()){throw new Error("Creation of component '"+e.name+"' is not possible due to inactive owner component '"+t.getId()+"'")}return t.runAsOwner(n)}else{return n()}};O._applyCacheToken=function(e,t,n){var i=sap.ui.getCore().getConfiguration();var r=n?"Model":"DataSource";var a=n?'["sap.ui5"]["models"]':'["sap.app"]["dataSources"]';var o=n&&n["sap-language"]||e.search(true)["sap-language"];var s=n&&n["sap-client"]||e.search(true)["sap-client"];if(!o){d.warning('Component Manifest: Ignoring provided "sap-context-token='+t.cacheToken+'" for '+r+' "'+t.dataSource+'" ('+e.toString()+"). "+'Missing "sap-language" URI parameter',a+'["'+t.dataSource+'"]',t.componentName);return}if(!s){d.warning('Component Manifest: Ignoring provided "sap-context-token='+t.cacheToken+'" for '+r+' "'+t.dataSource+'" ('+e.toString()+"). "+'Missing "sap-client" URI parameter',a+'["'+t.dataSource+'"]',t.componentName);return}if(s!==i.getSAPParam("sap-client")){d.warning('Component Manifest: Ignoring provided "sap-context-token='+t.cacheToken+'" for '+r+' "'+t.dataSource+'" ('+e.toString()+"). "+'URI parameter "sap-client='+s+'" must be identical with configuration "sap-client='+i.getSAPParam("sap-client")+'"',a+'["'+t.dataSource+'"]',t.componentName);return}if(e.hasQuery("sap-context-token")&&!e.hasQuery("sap-context-token",t.cacheToken)||n&&n["sap-context-token"]&&n["sap-context-token"]!==t.cacheToken){d.warning('Component Manifest: Overriding existing "sap-context-token='+(e.query(true)["sap-context-token"]||n["sap-context-token"])+'" with provided value "'+t.cacheToken+'" for '+r+' "'+t.dataSource+'" ('+e.toString()+").",a+'["'+t.dataSource+'"]',t.componentName)}if(n){if(e.hasQuery("sap-context-token")){d.warning('Component Manifest: Move existing "sap-context-token='+e.query(true)["sap-context-token"]+'" to metadataUrlParams for '+r+' "'+t.dataSource+'" ('+e.toString()+").",a+'["'+t.dataSource+'"]',t.componentName)}e.removeQuery("sap-context-token");n["sap-context-token"]=t.cacheToken}else{e.setQuery("sap-context-token",t.cacheToken)}};O._createManifestModelConfigurations=function(e){var n=e.component;var i=e.manifest||n.getManifestObject();var r=e.mergeParent;var a=e.cacheTokens||{};var o=n?n.toString():i.getComponentName();var s=sap.ui.getCore().getConfiguration();var u=e.activeTerminologies;if(!e.models){return null}var f={models:e.models,dataSources:e.dataSources||{},origin:{dataSources:{},models:{}}};if(n&&r){var p=n.getMetadata();while(p instanceof t){var l=p.getManifestObject();var g=p.getManifestEntry("/sap.app/dataSources");w(f.dataSources,f.origin.dataSources,g,l);var m=p.getManifestEntry("/sap.ui5/models");w(f.models,f.origin.models,m,l);p=p.getParent()}}var h={};for(var v in f.models){var y=f.models[v];var M=false;var C=null;if(typeof y==="string"){y={dataSource:y}}if(y.dataSource){var b=f.dataSources&&f.dataSources[y.dataSource];if(typeof b==="object"){if(b.type===undefined){b.type="OData"}var S;if(!y.type){switch(b.type){case"OData":S=b.settings&&b.settings.odataVersion;if(S==="4.0"){y.type="sap.ui.model.odata.v4.ODataModel"}else if(!S||S==="2.0"){y.type="sap.ui.model.odata.v2.ODataModel"}else{d.error('Component Manifest: Provided OData version "'+S+'" in '+'dataSource "'+y.dataSource+'" for model "'+v+'" is unknown. '+'Falling back to default model type "sap.ui.model.odata.v2.ODataModel".','["sap.app"]["dataSources"]["'+y.dataSource+'"]',o);y.type="sap.ui.model.odata.v2.ODataModel"}break;case"JSON":y.type="sap.ui.model.json.JSONModel";break;case"XML":y.type="sap.ui.model.xml.XMLModel";break;default:}}if(y.type==="sap.ui.model.odata.v4.ODataModel"&&b.settings&&b.settings.odataVersion){y.settings=y.settings||{};y.settings.odataVersion=b.settings.odataVersion}if(!y.uri){y.uri=b.uri;M=true}if(b.type==="OData"&&b.settings&&typeof b.settings.maxAge==="number"){y.settings=y.settings||{};y.settings.headers=y.settings.headers||{};y.settings.headers["Cache-Control"]="max-age="+b.settings.maxAge}if(b.type==="OData"&&b.settings&&b.settings.annotations){var E=b.settings.annotations;for(var P=0;P<E.length;P++){var A=E[P];var T=f.dataSources[A];if(!T){d.error('Component Manifest: ODataAnnotation "'+A+'" for dataSource "'+y.dataSource+'" could not be found in manifest','["sap.app"]["dataSources"]["'+A+'"]',o);continue}if(T.type!=="ODataAnnotation"){d.error('Component Manifest: dataSource "'+A+'" was expected to have type "ODataAnnotation" but was "'+T.type+'"','["sap.app"]["dataSources"]["'+A+'"]',o);continue}if(!T.uri){d.error('Component Manifest: Missing "uri" for ODataAnnotation "'+A+'"','["sap.app"]["dataSources"]["'+A+'"]',o);continue}var D=new c(T.uri);if(y.type==="sap.ui.model.odata.v2.ODataModel"||y.type==="sap.ui.model.odata.v4.ODataModel"){var U=a.dataSources&&a.dataSources[T.uri];if(U||y.type==="sap.ui.model.odata.v2.ODataModel"){["sap-language","sap-client"].forEach(function(e){if(!D.hasQuery(e)&&s.getSAPParam(e)){D.setQuery(e,s.getSAPParam(e))}})}if(U){O._applyCacheToken(D,{cacheToken:U,componentName:o,dataSource:A})}}var k=f.origin.dataSources[E[P]]||i;var I=k._resolveUri(D).toString();y.settings=y.settings||{};y.settings.annotationURI=y.settings.annotationURI||[];y.settings.annotationURI.push(I)}}}else{d.error('Component Manifest: dataSource "'+y.dataSource+'" for model "'+v+'" not found or invalid','["sap.app"]["dataSources"]["'+y.dataSource+'"]',o);continue}}if(!y.type){d.error('Component Manifest: Missing "type" for model "'+v+'"','["sap.ui5"]["models"]["'+v+'"]',o);continue}if(y.type==="sap.ui.model.odata.ODataModel"&&(!y.settings||y.settings.json===undefined)){y.settings=y.settings||{};y.settings.json=true}if(y.type==="sap.ui.model.resource.ResourceModel"){if(y.uri&&y.settings&&y.settings.bundleUrl){d.warning("Defining both model uri and bundleUrl is not supported. Only model uri will be resolved.")}if(!y.uri&&y.settings&&y.settings.terminologies){if(y.bundleUrl||y.settings.bundleUrl){y.uri=y.bundleUrl||y.settings.bundleUrl;delete y.settings.bundleUrl}}}if(y.uri){var j=new c(y.uri);var N=(M?f.origin.dataSources[y.dataSource]:f.origin.models[v])||i;j=N._resolveUri(j);if(y.dataSource){_(j);if(y.type==="sap.ui.model.odata.v2.ODataModel"||y.type==="sap.ui.model.odata.v4.ODataModel"){var x=f.dataSources&&f.dataSources[y.dataSource];var R=a.dataSources&&a.dataSources[x.uri];C=y.settings&&y.settings.metadataUrlParams;var B=(!C||typeof C["sap-language"]==="undefined")&&!j.hasQuery("sap-language")&&s.getSAPParam("sap-language");if(B&&y.type==="sap.ui.model.odata.v2.ODataModel"||R){y.settings=y.settings||{};C=y.settings.metadataUrlParams=y.settings.metadataUrlParams||{};if(B){C["sap-language"]=s.getSAPParam("sap-language")}}if(R){O._applyCacheToken(j,{cacheToken:R,componentName:o,dataSource:v},C)}}}y.uri=j.toString()}if(y.uriSettingName===undefined){switch(y.type){case"sap.ui.model.odata.ODataModel":case"sap.ui.model.odata.v2.ODataModel":case"sap.ui.model.odata.v4.ODataModel":y.uriSettingName="serviceUrl";break;case"sap.ui.model.resource.ResourceModel":y.uriSettingName="bundleUrl";break;default:}}var F;var H;if(n){H=n.getComponentData()}else{H=e.componentData}F=H&&H.startupParameters&&H.startupParameters["sap-system"];if(!F){F=s.getSAPParam("sap-system")}var W=false;var L;if(F&&["sap.ui.model.odata.ODataModel","sap.ui.model.odata.v2.ODataModel"].indexOf(y.type)!=-1){W=true;L=sap.ui.requireSync("sap/ui/model/odata/ODataUtils")}if(y.uri){if(W){y.preOriginBaseUri=y.uri.split("?")[0];y.uri=L.setOrigin(y.uri,{alias:F});y.postOriginBaseUri=y.uri.split("?")[0]}if(y.uriSettingName!==undefined){y.settings=y.settings||{};if(!y.settings[y.uriSettingName]){y.settings[y.uriSettingName]=y.uri}}else if(y.settings){y.settings=[y.uri,y.settings]}else{y.settings=[y.uri]}}else if(W&&y.uriSettingName!==undefined&&y.settings&&y.settings[y.uriSettingName]){y.preOriginBaseUri=y.settings[y.uriSettingName].split("?")[0];y.settings[y.uriSettingName]=L.setOrigin(y.settings[y.uriSettingName],{alias:F});y.postOriginUri=y.settings[y.uriSettingName].split("?")[0]}if(W&&y.settings&&y.settings.annotationURI){var V=[].concat(y.settings.annotationURI);var q=[];for(var J=0;J<V.length;J++){q.push(L.setAnnotationOrigin(V[J],{alias:F,preOriginBaseUri:y.preOriginBaseUri,postOriginBaseUri:y.postOriginBaseUri}))}y.settings.annotationURI=q}if(y.type==="sap.ui.model.resource.ResourceModel"&&y.settings){if(u){y.settings.activeTerminologies=u}i._processResourceConfiguration(y.settings,undefined,true)}if(y.settings&&!Array.isArray(y.settings)){y.settings=[y.settings]}h[v]=y}if(i.getEntry("/sap.ui5/commands")||n&&n._getManifestEntry("/sap.ui5/commands",true)){h["$cmd"]={type:"sap.ui.model.json.JSONModel"}}return h};O._createManifestModels=function(e,t){var n={};for(var i in e){var r=e[i];try{sap.ui.requireSync(r.type.replace(/\./g,"/"))}catch(e){d.error('Component Manifest: Class "'+r.type+'" for model "'+i+'" could not be loaded. '+e,'["sap.ui5"]["models"]["'+i+'"]',t);continue}var a=l.get(r.type);if(!a){d.error('Component Manifest: Class "'+r.type+'" for model "'+i+'" could not be found','["sap.ui5"]["models"]["'+i+'"]',t);continue}var o=[null].concat(r.settings||[]);var s=a.bind.apply(a,o);var u=new s;n[i]=u}return n};function P(e,t,n,i){var r={afterManifest:{},afterPreload:{}};var o=a({},e.getEntry("/sap.app/dataSources"));var s=a({},e.getEntry("/sap.ui5/models"));var u=O._createManifestModelConfigurations({models:s,dataSources:o,manifest:e,componentData:t,cacheTokens:n,activeTerminologies:i});var c=g.fromQuery(window.location.search).get("sap-ui-xx-preload-component-models-"+e.getComponentName());var f=c&&c.split(",");for(var p in u){var l=u[p];if(!l.preload&&f&&f.indexOf(p)>-1){l.preload=true;d.warning('FOR TESTING ONLY!!! Activating preload for model "'+p+'" ('+l.type+")",e.getComponentName(),"sap.ui.core.Component")}if(l.type==="sap.ui.model.resource.ResourceModel"&&Array.isArray(l.settings)&&l.settings.length>0&&l.settings[0].async!==true){r.afterPreload[p]=l}else if(l.preload){if(sap.ui.loader._.getModuleState(l.type.replace(/\./g,"/")+".js")){r.afterManifest[p]=l}else{d.warning('Can not preload model "'+p+'" as required class has not been loaded: "'+l.type+'"',e.getComponentName(),"sap.ui.core.Component")}}}return r}function A(e){return sap.ui.require.toUrl(e.replace(/\./g,"/")+"/manifest.json")}function T(e,t){h.registerResourcePath(e.replace(/\./g,"/"),t)}function D(e){var n=[];var i=[];function r(e){if(!e._oManifest){var a=e.getComponentName();var o=A(a);var s=h.loadResource({url:o,dataType:"json",async:true}).catch(function(e){d.error('Failed to load component manifest from "'+o+'" (component '+a+")! Reason: "+e);return{}});n.push(s);i.push(e)}var u=e.getParent();if(u&&u instanceof t&&!u.isBaseClass()){r(u)}}r(e);return Promise.all(n).then(function(e){for(var t=0;t<e.length;t++){if(e[t]){i[t]._applyManifest(e[t])}}})}O._fnLoadComponentCallback=null;O._fnOnInstanceCreated=null;O._fnPreprocessManifest=null;O.create=function(e){if(e==null||typeof e!=="object"){throw new TypeError("Component.create() must be called with a configuration object.")}var t=a({},e);t.async=true;if(t.manifest===undefined){t.manifest=true}return U(t)};sap.ui.component=function(e){if(!e){throw new Error("sap.ui.component cannot be called without parameter!")}var t=function(e){return{type:"sap.ui.component",name:e}};if(typeof e==="string"){d.warning("Do not use deprecated function 'sap.ui.component' ("+e+") + for Component instance lookup. "+"Use 'Component.get' instead","sap.ui.component",null,t.bind(null,e));return sap.ui.getCore().getComponent(e)}if(e.async){d.info("Do not use deprecated factory function 'sap.ui.component' ("+e["name"]+"). "+"Use 'Component.create' instead","sap.ui.component",null,t.bind(null,e["name"]))}else{d.warning("Do not use synchronous component creation ("+e["name"]+")! "+"Use the new asynchronous factory 'Component.create' instead","sap.ui.component",null,t.bind(null,e["name"]))}return U(e,true)};function U(e,n){var r=O.get(o._sOwnerId);var a=e.activeTerminologies||r&&r.getActiveTerminologies()||sap.ui.getCore().getConfiguration().getActiveTerminologies();if(!e.asyncHints||!e.asyncHints.cacheTokens){var s=r&&r._mCacheTokens;if(typeof s==="object"){e.asyncHints=e.asyncHints||{};e.asyncHints.cacheTokens=s}}function u(e,t){if(t.async){var n=e.rootControlLoaded?e.rootControlLoaded():Promise.resolve();var i=typeof O._fnOnInstanceCreated==="function"?O._fnOnInstanceCreated(e,t):Promise.resolve();return Promise.all([n,i])}else if(typeof O._fnOnInstanceCreated==="function"){O._fnOnInstanceCreated(e,t)}return e}function c(t){if(n&&t.getMetadata().isA("sap.ui.core.IAsyncContentCreation")){throw new Error("Do not use deprecated factory function 'sap.ui.component' in combination with IAsyncContentCreation ("+e["name"]+"). "+"Use 'Component.create' instead")}var r=e.name,o=e.id,s=e.componentData,c=r+".Component",f=e.settings;var l=new t(i({},f,{id:o,componentData:s,_cacheTokens:e.asyncHints&&e.asyncHints.cacheTokens,_activeTerminologies:a}));p(l instanceof O,'The specified component "'+c+'" must be an instance of sap.ui.core.Component!');d.info("Component instance Id = "+l.getId());var g=l.getMetadata().handleValidation()!==undefined||e.handleValidation;if(g){if(l.getMetadata().handleValidation()!==undefined){g=l.getMetadata().handleValidation()}else{g=e.handleValidation}sap.ui.getCore().getMessageManager().registerObject(l,g)}var m=E(l,e.async);if(e.async){return u(l,e).then(function(){return Promise.all(m)}).then(function(){return l})}else{return u(l,e)}}var f=k(e,{failOnError:true,createModels:true,waitFor:e.asyncHints&&e.asyncHints.waitFor,activeTerminologies:a});if(e.async){var l=o._sOwnerId;return f.then(function(e){var n=function(e){var i=e.getParent();var r=Promise.resolve();if(i instanceof t){r=r.then(function(){return n(i)})}return r.then(function(){return e.getManifestObject().loadDependenciesAndIncludes(true)})};return n(e.getMetadata()).then(function(){return S(function(){return c(e)},l)})})}else{return c(f)}}O.load=function(e){var t=a({},e);t.async=true;if(t.manifest===undefined){t.manifest=true}return k(t,{preloadOnly:t.asyncHints&&t.asyncHints.preloadOnly})};O.get=function(e){return sap.ui.getCore().getComponent(e)};sap.ui.component.load=function(e,t){d.warning("Do not use deprecated function 'sap.ui.component.load'! Use 'Component.load' instead");return k(e,{failOnError:t,preloadOnly:e.asyncHints&&e.asyncHints.preloadOnly})};function k(t,n){var i=n.activeTerminologies,o=t.name,s=t.url,u=sap.ui.getCore().getConfiguration(),c=/^(sync|async)$/.test(u.getComponentPreload()),l=t.manifest,g,m,h,M,_,w;function C(n,i){var r=JSON.parse(JSON.stringify(n));if(t.async){return S(r).then(function(t){return new e(t,i)})}else{return new e(r,i)}}function S(e){if(typeof O._fnPreprocessManifest==="function"&&e!=null){try{var n=r({},t);return O._fnPreprocessManifest(e,n)}catch(e){d.error("Failed to execute flexibility hook for manifest preprocessing.",e);return Promise.reject(e)}}else{return Promise.resolve(e)}}p(!s||typeof s==="string","sUrl must be a string or undefined");if(o&&typeof s==="string"){T(o,s)}f.setStepComponent(o);if(l===undefined){g=t.manifestFirst===undefined?u.getManifestFirst():!!t.manifestFirst;m=t.manifestUrl}else{if(t.async===undefined){t.async=true}g=!!l;m=l&&typeof l==="string"?l:undefined;h=l&&typeof l==="object"?C(l,{url:t&&t.altManifestUrl,activeTerminologies:i}):undefined}if(!h&&m){h=e.load({activeTerminologies:i,manifestUrl:m,componentName:o,processJson:S,async:t.async,failOnError:true})}if(h&&!t.async){o=h.getComponentName();if(o&&typeof s==="string"){T(o,s)}}if(!(h&&t.async)){if(!o){throw new Error("The name of the component is undefined.")}p(typeof o==="string","sName must be a string")}if(g&&!h){h=e.load({activeTerminologies:i,manifestUrl:A(o),componentName:o,async:t.async,processJson:S,failOnError:false})}function E(){return(o+".Component").replace(/\./g,"/")}function U(e){var t=o+".Component";if(!e){var i="The specified component controller '"+t+"' could not be found!";if(n.failOnError){throw new Error(i)}else{d.warning(i)}}if(h){var r=b(e.getMetadata(),h);var a=function(){var t=Array.prototype.slice.call(arguments);var n;if(t.length===0||typeof t[0]==="object"){n=t[0]=t[0]||{}}else if(typeof t[0]==="string"){n=t[1]=t[1]||{}}n._metadataProxy=r;if(M){n._manifestModels=M}var i=Object.create(e.prototype);e.apply(i,t);return i};a.getMetadata=function(){return r};a.extend=function(){throw new Error("Extending Components created by Manifest is not supported!")};return a}else{return e}}function k(e,t){p(typeof e==="string"&&e||typeof e==="object"&&typeof e.name==="string"&&e.name,"reference either must be a non-empty string or an object with a non-empty 'name' and an optional 'url' property");if(typeof e==="object"){if(e.url){T(e.name,e.url)}return e.lazy&&t!==true?undefined:e.name}return e}function I(e,t){var n=e+".Component",i=sap.ui.getCore().getConfiguration().getDepCache(),r,a,o;if(c&&e!=null&&!sap.ui.loader._.getModuleState(n.replace(/\./g,"/")+".js")){if(t){a=v._getTransitiveDependencyForComponent(e);if(a&&!a.hasOwnPreload){o=[a.library];Array.prototype.push.apply(o,a.dependencies);return sap.ui.getCore().loadLibraries(o,{preloadOnly:true})}else{r=n.replace(/\./g,"/")+(i?"-h2-preload.js":"-preload.js");return sap.ui.loader._.loadJSResourceAsync(r,true)}}try{r=n+"-preload";sap.ui.requireSync(r.replace(/\./g,"/"))}catch(e){d.warning("couldn't preload component from "+r+": "+(e&&e.message||e))}}else if(t){return Promise.resolve()}}function j(e,t,n){var i=[];var r=n?function(e){i.push(e)}:function(){};var a=t.getEntry("/sap.ui5/dependencies/libs");if(a){var o=[];for(var s in a){if(!a[s].lazy){o.push(s)}}if(o.length>0){d.info('Component "'+e+'" is loading libraries: "'+o.join(", ")+'"');r(sap.ui.getCore().loadLibraries(o,{async:n}))}}var u=t.getEntry("/sap.ui5/extends/component");if(u){r(I(u,n))}var c=[];var f=t.getEntry("/sap.ui5/dependencies/components");if(f){for(var p in f){if(!f[p].lazy){c.push(p)}}}var l=t.getEntry("/sap.ui5/componentUsages");if(l){for(var g in l){if(l[g].lazy===false&&c.indexOf(l[g].name)===-1){c.push(l[g].name)}}}if(c.length>0){c.forEach(function(e){r(I(e,n))})}return n?Promise.all(i):undefined}if(t.async){var N=t.asyncHints||{},x=[],R=function(e){e=e.then(function(e){return{result:e,rejected:false}},function(e){return{result:e,rejected:true}});return e},B=function(e){if(e){x.push(R(e))}},F=function(e){return e},H,W;H=[];if(Array.isArray(N.preloadBundles)){N.preloadBundles.forEach(function(e){H.push(sap.ui.loader._.loadJSResourceAsync(k(e,true),true))})}if(Array.isArray(N.libs)){W=N.libs.map(k).filter(F);H.push(sap.ui.getCore().loadLibraries(W,{preloadOnly:true}))}H=Promise.all(H);if(W&&!n.preloadOnly){H=H.then(function(){return sap.ui.getCore().loadLibraries(W)})}B(H);if(N.components){Object.keys(N.components).forEach(function(e){B(I(k(N.components[e]),true))})}if(!h){B(I(o,true))}else{var L=[];h=h.then(function(e){var t=e.getComponentName();if(typeof s==="string"){T(t,s)}e.defineResourceRoots();e._preprocess({resolveUI5Urls:true,i18nProperties:L});return e});if(n.createModels){B(h.then(function(e){_=P(e,t.componentData,N.cacheTokens,i);return e}).then(function(e){if(Object.keys(_.afterManifest).length>0){M=O._createManifestModels(_.afterManifest,e.getComponentName())}return e}))}B(h.then(function(e){var t=Promise.resolve();if(!e.getEntry("/sap.app/embeddedBy")){t=I(e.getComponentName(),true)}return t.then(function(){return e._processI18n(true,L)}).then(function(){if(!n.createModels){return null}var t=Object.keys(_.afterPreload);if(t.length===0){return null}return new Promise(function(e,t){sap.ui.require(["sap/ui/model/resource/ResourceModel"],function(t){e(t)},t)}).then(function(i){function r(t){var r=_.afterPreload[t];if(Array.isArray(r.settings)&&r.settings.length>0){var a=r.settings[0];a.activeTerminologies=n.activeTerminologies;return i.loadResourceBundle(a,true).then(function(e){a.bundle=e;delete a.terminologies;delete a.activeTerminologies;delete a.enhanceWith},function(n){d.error("Component Manifest: Could not preload ResourceBundle for ResourceModel. "+"The model will be skipped here and tried to be created on Component initialization.",'["sap.ui5"]["models"]["'+t+'"]',e.getComponentName());d.error(n);delete _.afterPreload[t]})}else{return Promise.resolve()}}return Promise.all(t.map(r)).then(function(){if(Object.keys(_.afterPreload).length>0){var t=O._createManifestModels(_.afterPreload,e.getComponentName());if(!M){M={}}for(var n in t){M[n]=t[n]}}})})})}));w=function(e){if(typeof O._fnLoadComponentCallback==="function"){var n=r({},t);try{return O._fnLoadComponentCallback(n,e)}catch(t){d.error('Callback for loading the component "'+e.getComponentName()+'" run into an error. The callback was skipped and the component loading resumed.',t,"sap.ui.core.Component")}}}}return Promise.all(x).then(function(e){var t=[],n=false,i;n=e.some(function(e){if(e&&e.rejected){i=e.result;return true}t.push(e.result)});if(n){return Promise.reject(i)}return t}).then(function(e){if(h&&w){return h.then(w).then(function(){return e})}return e}).then(function(e){d.debug("Component.load: all promises fulfilled, then "+e);if(h){return h.then(function(e){if(!e._bLoadManifestRequestFailed){h=e;o=h.getComponentName();return j(o,h,true)}else{h=undefined;return h}})}else{return e}}).then(function(){if(n.preloadOnly){return true}return new Promise(function(e,t){sap.ui.require([E()],function(t){e(t)},t)}).then(function(t){var r=t.getMetadata();var a=r.getComponentName();var o=A(a);var s;if(h&&typeof l!=="object"&&(typeof m==="undefined"||m===o)){r._applyManifest(JSON.parse(JSON.stringify(h.getRawJson())))}s=D(r);return s.then(function(){var a=Promise.resolve();if(!h&&n.activeTerminologies){h=new e(r.getManifestObject().getRawJson(),{process:false,activeTerminologies:i});a=h._processI18n(true)}return a.then(U.bind(undefined,t))})})}).then(function(e){if(!h){return e}var t=[];var n;var r=h.getEntry("/sap.ui5/rootView");if(typeof r==="string"){n="XML"}else if(r&&typeof r==="object"&&r.type){n=r.type}if(n&&y[n]){var o="sap/ui/core/mvc/"+y[n]+"View";t.push(o)}var s=h.getEntry("/sap.ui5/routing");if(s&&s.routes){var u=h.getEntry("/sap.ui5/routing/config/routerClass")||"sap.ui.core.routing.Router";var c=u.replace(/\./g,"/");t.push(c)}var f=a({},h.getEntry("/sap.ui5/models"));var p=a({},h.getEntry("/sap.app/dataSources"));var l=O._createManifestModelConfigurations({models:f,dataSources:p,manifest:h,cacheTokens:N.cacheTokens,activeTerminologies:i});for(var g in l){if(!l.hasOwnProperty(g)){continue}var m=l[g];if(!m.type){continue}var v=m.type.replace(/\./g,"/");if(t.indexOf(v)===-1){t.push(v)}}if(t.length>0){return Promise.all(t.map(function(e){return new Promise(function(t,n){var i=false;function r(n){if(i){return}d.warning('Can not preload module "'+e+'". '+"This will most probably cause an error once the module is used later on.",h.getComponentName(),"sap.ui.core.Component");d.warning(n);i=true;t()}sap.ui.require([e],t,r)})})).then(function(){return e})}else{return e}}).then(function(e){var t=n.waitFor;if(t){var i=Array.isArray(t)?t:[t];return Promise.all(i).then(function(){return e})}return e}).catch(function(e){if(M){for(var t in M){var n=M[t];if(n&&typeof n.destroy==="function"){n.destroy()}}}throw e})}if(h){h.defineResourceRoots();h._preprocess({resolveUI5Urls:true});j(o,h)}I(o);return U(sap.ui.requireSync(E()))}if(Math.sqrt(2)<1){sap.ui.require(["sap/ui/core/Core"],function(){})}O.prototype.getCommand=function(e){var t,n=this._getManifestEntry("/sap.ui5/commands",true);if(n&&e){t=n[e]}return e?t:n};O.prototype.deactivate=function(){var e=O.getOwnerComponentFor(this);if(e&&e.isActive()){throw new Error("Component.deactivate must not be called on nested components.")}if(!this.isKeepAliveSupported()){d.warning("Deactivation of component failed. Component '"+this.getId()+"' does not support 'keepAlive'.");return}if(!this.isActive()){d.warning("Deactivation of component failed. Component '"+this.getId()+"' is already inactive.");return}this.onOwnerDeactivation();this._bIsActive=false;n.registry.filter(function(e){var t=O.getOwnerIdFor(e);if(t===this.getId()){u.suspend(e.getDomRef());return e.onOwnerDeactivation()}},this);O.registry.filter(function(e){var t=O.getOwnerIdFor(e);if(t===this.getId()){e.deactivate()}},this);if(this._oEventBus){this._oEventBus.suspend()}if(this.getRouter()){this.getRouter().stop()}if(typeof this.onDeactivate==="function"){this.onDeactivate()}};O.prototype.activate=function(){if(!this.isKeepAliveSupported()){d.warning("Activation of component failed. Component '"+this.getId()+"' does not support 'keepAlive'.");return}if(this.isActive()){d.warning("Activation of component failed. Component '"+this.getId()+"' is already active.");return}this.onOwnerActivation();this._bIsActive=true;n.registry.forEach(function(e){var t=O.getOwnerIdFor(e);if(t===this.getId()){u.resume(e.getDomRef());return e.onOwnerActivation()}},this);O.registry.forEach(function(e){var t=O.getOwnerIdFor(e);if(t===this.getId()){e.activate()}},this);if(this._oEventBus){this._oEventBus.resume()}if(this.getRouter()){this.getRouter().initialize()}if(typeof this.onActivate==="function"){this.onActivate()}};O.prototype.isKeepAliveSupported=function(){var e=this._oKeepAliveConfig&&this._oKeepAliveConfig.supported;if(e){e=O.registry.filter(function(e){var t=O.getOwnerIdFor(e);if(t===this.getId()){return true}},this).every(function(e){return e.isKeepAliveSupported()},this)}return!!e};O.prototype.registerForDestroy=function(e){var t=this._getDestroyables();e=e.then(function(n){t.splice(t.indexOf(e),1);return n});t.push(e)};return O});